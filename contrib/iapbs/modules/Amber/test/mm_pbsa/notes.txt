
== iAPBS/Amber ==

export AMBERHOME=something

export MCSH_HOME=/dev/null


$AMBERHOME/exe/mm_pbsa.pl test.mmpbsa > LOG


$AMBERHOME/exe/mm_pbsa_statistics.pl  2 0 snapshot_statistics.in OO


to-do

+ add support for grid x/y/z options to mmbsa input file
+ also for number of points in x/y/z
- disable check of PB section? Or modify it.

+ in apbs_driver support for automatic adjustment of # of points for a
  given grid resolution


== PBSA/Amber ==

cd /home/rok/SandBox-091207/MMPBSA/Tutorial/prod/Test/PBSA
export AMBERHOME=/home/rok/SandBox-091207/amber9

/home/rok/SandBox-091207/amber9/exe/mm_pbsa.pl test-pbsa.mmpbsa > LOG
../mm_pbsa.pl  test-pbsa.mmpbsa > LOG.1



== Recipe ==

COMPT                 ./Prmtop/ras-raf.prmtop
RECPT                 ./Prmtop/ras.prmtop
LIGPT                 ./Prmtop/raf.prmtop

Run ampdb on each, ligand, receptor and complex, to generate pdb files:

$AMBERHOME/exe/ambpdb -p ../Prmtop/ras-raf.prmtop -noter < snapshot_com.crd.1 > com.pdb
$AMBERHOME/exe/ambpdb -p ../Prmtop/ras.prmtop -noter < snapshot_rec.crd.1 > rec.pdb
$AMBERHOME/exe/ambpdb -p ../Prmtop/raf.prmtop -noter < snapshot_lig.crd.1 > lig.pdb

Run pdb2pqr to generate pqr files from the pdb files:

/opt/apbs-0.5.0/pdb2pqr/pdb2pqr.py --assign-only --ff=amber com.pdb com.pqr
/opt/apbs-0.5.0/pdb2pqr/pdb2pqr.py --assign-only --ff=amber rec.pdb rec.pqr
/opt/apbs-0.5.0/pdb2pqr/pdb2pqr.py --assign-only --ff=amber lig.pdb lig.pqr


Run psize on complex and receptor pqr files, to get size of the system:

/opt/apbs-0.5.0/tools/manip/psize.py  --gmemceil=1000 com.pqr
/opt/apbs-0.5.0/tools/manip/psize.py  --gmemceil=1000 rec.pqr


From the previous run get the following numbers (take the largest ones):
Coarse grid dims
Fine grid dims
Num. fine grid pts.

and fill them in to mm-pbsa input file to these variables (in the PB section):
CGLEN x, y, z
FGLEN x, y, z
DIME  x, y, z

Run this to get amber-ready pqr files:

grep ATOM com.pqr > _com.pqr
grep ATOM lig.pqr > _lig.pqr
grep ATOM rec.pqr > _rec.pqr


== Settings ==

    mg-auto
    dime  161 161 161
    cglen 80 80 80
    fglen 58 58 58
    cgcent mol 3
    fgcent mol 3
    mol 1
    lpbe
    bcfl mdh : 2
    ion 1 0.000 2.0
    ion -1 0.000 2.0
    pdie 1
    sdie 80
    srfm smol : 1
    chgm spl2 : 1
    sdens 10
    srad 1.40
    swin 0.30
    temp 298.15
    gamma 0.105
    calcenergy total
    calcforce no

1: amber ff
  print OUT "    apbs_print=0, apbs_debug=0, calc_type = 0,\n";
  print OUT "    grid = ${space}, ${space}, ${space},\n";
  print OUT "    nion=0, radiopt = ${radiopt}, pqr='pqr', \n";
  print OUT "   sdie = ${epsout}, pdie = ${epsin}, srad=0.0, \n";
  print OUT "   cmeth=1, bcfl=2, srfm=0, chgm=0, swin=0.3,
  calcforce=0,\n";

2: amber ff
  print OUT "    apbs_print=0, apbs_debug=0, calc_type = 0,\n";
  print OUT "    grid = ${space}, ${space}, ${space},\n";
  print OUT "    nion=0, radiopt = ${radiopt}, pqr='pqr', \n";
  print OUT "   sdie = ${epsout}, pdie = ${epsin}, srad=1.4, \n";
  print OUT "   cmeth=1, bcfl=2, srfm=1, chgm=1, swin=0.3,
  calcforce=0,\n";

3: parse ff
  same as 2

4: default internal amber
  same as 2

6: default internal amber
  same as 2
  new version of iAPBS, i386 build


