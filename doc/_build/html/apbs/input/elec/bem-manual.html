<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>bem-manual &#8212; APBS-PDB2PQR 1.6 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="bcfl" href="bcfl.html" />
    <link rel="prev" title="ELEC input file section" href="index.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="bem-manual">
<span id="bemmanual"></span><h1>bem-manual<a class="headerlink" href="#bem-manual" title="Permalink to this headline">¶</a></h1>
<p>This mode uses the TABI-PB integral equation software from Geng and Krasny to solve the linearized Poisson-Boltmzann equation.
Boundary element methods offer the ability to focus numerical effort on a much smaller region of the problem domain:  the interface between the molecule and the solvent.
In this method, two coupled integral equations defined on the solute-solvent boundary define a mathematical relationship between the electrostatic surface potential and its normal derivative with a set of integral kernels consisting of Coulomb and screened Coulomb potentials with their normal derivatives.
The boundary element method requires a surface triangulation, generated by a program such as <a class="reference external" href="http://mgl.scripps.edu/people/sanner/html/msms_home.html">MSMS</a> or <a class="reference external" href="https://www.electrostaticszone.eu/downloads">NanoShaper</a>, on which to discretize the integral equations.</p>
<p>For more information, see the Geng &amp; Krasny <a class="reference external" href="https://doi.org/10.1016/j.jcp.2013.03.056">2013 J Comput Phys paper</a>.</p>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">ELEC bem-manual keywords</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="bcfl.html">bcfl</a></li>
<li class="toctree-l1"><a class="reference internal" href="ion.html">ion</a></li>
<li class="toctree-l1"><a class="reference internal" href="lpbe.html">lpbe</a></li>
<li class="toctree-l1"><a class="reference internal" href="mac.html">mac</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh.html">mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/mol.html">mol</a></li>
<li class="toctree-l1"><a class="reference internal" href="outdata.html">outdata</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdie.html">pdie</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/sdens.html">sdens</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdie.html">sdie</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/srad.html">srad</a></li>
<li class="toctree-l1"><a class="reference internal" href="srfm.html">srfm (elec)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/swin.html">swin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/temp.html">temp</a></li>
<li class="toctree-l1"><a class="reference internal" href="tree_n0.html">tree_n0</a></li>
<li class="toctree-l1"><a class="reference internal" href="tree_order.html">tree_order</a></li>
</ul>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Why are <code class="docutils literal"><span class="pre">srfm</span></code>, <code class="docutils literal"><span class="pre">srad</span></code>, etc. included in <code class="docutils literal"><span class="pre">bem-manual</span></code> input files when the surface type is determined by the mesh?
Documented as issue <a class="reference external" href="https://github.com/Electrostatics/apbs-pdb2pqr/issues/483">https://github.com/Electrostatics/apbs-pdb2pqr/issues/483</a></p>
</div>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">If there&#8217;s only one mode, then we can change <code class="docutils literal"><span class="pre">bem-manual</span></code> to just <code class="docutils literal"><span class="pre">bem</span></code> or <code class="docutils literal"><span class="pre">tabi</span></code>.
Documented as issue <a class="reference external" href="https://github.com/Electrostatics/apbs-pdb2pqr/issues/484">https://github.com/Electrostatics/apbs-pdb2pqr/issues/484</a></p>
</div>
<div class="section" id="background-information">
<h2>Background information<a class="headerlink" href="#background-information" title="Permalink to this headline">¶</a></h2>
<p>The Treecode-Accelerated Boundary Integral Poisson-Boltzmann solver (TABI-PB; <a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S0021999113002404">Geng, 2013</a> calculates electrostatics of solvated biomolecules governed by the linearized Poisson-Boltzmann equation.
It uses a well-posed boundary integral Poisson-Boltzmann formulation to ensure rapid convergence.
In addition, a fast treecode algorithm for the screened Coulomb potential <a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S0021999109000916">(Li, 2009)</a> is applied to speed up the matrix-vector products in each GMRES iteration.
The molecular surfaces, which divide the entire domain into solute region and solvent region, are generated by <a class="reference external" href="http://mgl.scripps.edu/people/sanner/html/msms_home.html">MSMS</a> or <a class="reference external" href="https://www.electrostaticszone.eu/downloads">NanoShaper</a>.</p>
<div class="section" id="tabi-pb-algorithm">
<h3>TABI-PB algorithm<a class="headerlink" href="#tabi-pb-algorithm" title="Permalink to this headline">¶</a></h3>
<p>The coupled integral equations derived from the linearized Poisson-Boltzmann equation are</p>
<div class="math">
\[\begin{split}\frac{1}{2}(1+\epsilon)\phi({x})-\int_\Gamma(K_1({x},{y})\frac{\partial{\phi({y})}}{\partial{v}}+K_2({x},{y})\phi({y}))dS_{y} &amp;=S_1({x}) \\
\frac{1}{2}(1+\frac{1}{\epsilon})\frac{\partial{\phi({x})}}{\partial{v}}-\int_\Gamma(K_3({x},{y})\frac{\partial{\phi({y})}}{\partial{v}}+K_4({x},{y})\phi({y}))dS_{y} &amp;=S_2({x}), {x}\in\Gamma\end{split}\]</div>
<p>for the surface potential <span class="math">\(\phi\)</span>, and its normal derivative <span class="math">\(\frac{\partial\phi}{\partial v}\)</span> on the surface :math`Gamma`.
The kernels <span class="math">\(K_{1,2,3,4}\)</span> are linear combinations of the Coulomb and screened Coulomb potentials:</p>
<div class="math">
\[\begin{split}G_0({x},{y}) &amp;= \frac{1}{4\pi |{x}-{y}|} \\
G_{\kappa}({x},{y}) &amp;= \frac{e^{-\kappa|{x}-{y}|}}{4\pi |{x}-{y}|}\end{split}\]</div>
<p>and their first and second derivatives.</p>
<p>The sums in the discretized form of the integral equations above have the form of <em>N</em>-body interactions,</p>
<div class="math">
\[V_i = \sum_{j=1,j \neq i}^{N} q_j G({x}_i,{x}_j), i=1,\ldots,N\]</div>
<p>where <span class="math">\(G\)</span> is the screened Coulomb potential kernel, <span class="math">\({x}_i, {x}_j\)</span> are the centroids of the triangles, and <span class="math">\(q_j\)</span> is the charge at <span class="math">\({x}_j\)</span>.
The particles (centroids of the triangles) are divided into a hierarchy of clusters having a tree structure.
The treecode replaces the <span class="math">\(\mathcal{O}(N^2) particle-particle interactions by :math:\)</span>mathcal{O}(N log N) particle-cluster interactions and TABI-PB utilizes this feature efficiently.</p>
</div>
</div>
<div class="section" id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>The TABI-PB code produces an output file called <code class="file docutils literal"><span class="pre">surface_potential.dat</span></code> containing:</p>
<ul class="simple">
<li>number of nodes, number of triangles</li>
<li>node index, vertices, normal vector, surface potential (kcal mol<sup>-1</sup> e<sub>c</sub><sup>-1</sup>), surface potential normal derivatives (kcal mol<sup>-1</sup> e<sub>c</sub><sup>-1</sup> A<sup>-1</sup>)</li>
<li>connectivity data for MSMS surface triangulation</li>
</ul>
<p>The format is given below:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>num_node num_triangle
node_index x y z norm_x norm_y norm_z phi norm_phi
<span class="o">(</span>et cetera<span class="o">)</span>
node_index1 node_index2 node_index3
</pre></div>
</div>
<p>The TABI-PB code prints the free energy of solvation and Coulombic free energy in kcal/mol, along with some other information such as CPU time and the GMRES residuals at each step.</p>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">It would be nice if all APBS-related code used kJ/mol.
Documented as <a class="reference external" href="https://github.com/Electrostatics/apbs-pdb2pqr/issues/485">https://github.com/Electrostatics/apbs-pdb2pqr/issues/485</a></p>
</div>
<p>Additionally, TABI-PB can optionally output a VTK polygonal data file containing color mappable potentials and normal derivatives of potentials on the faces and vertices of the mesh.
The VTK file can be visualized using <a class="reference external" href="https://www.paraview.org/">ParaView</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">bem-manual</a><ul>
<li><a class="reference internal" href="#background-information">Background information</a><ul>
<li><a class="reference internal" href="#tabi-pb-algorithm">TABI-PB algorithm</a></li>
</ul>
</li>
<li><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">APBS</a><ul>
  <li><a href="../../invoking.html">Invoking APBS</a><ul>
  <li><a href="../index.html">APBS input files</a><ul>
  <li><a href="index.html">ELEC input file section</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">ELEC input file section</a></li>
      <li>Next: <a href="bcfl.html" title="next chapter">bcfl</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/apbs/input/elec/bem-manual.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Nathan Baker.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../../_sources/apbs/input/elec/bem-manual.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>