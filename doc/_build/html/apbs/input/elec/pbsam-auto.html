
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pbsam-auto &#8212; APBS-PDB2PQR 3.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="exp" href="exp.html" />
    <link rel="prev" title="xyz" href="xyz.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pbsam-auto">
<span id="pbsamauto"></span><h1>pbsam-auto<a class="headerlink" href="#pbsam-auto" title="Permalink to this headline">¶</a></h1>
<p>PB-SAM is a semi-analytical solution to the linearized Poisson-Boltzmann equation for multiple molecules of arbitrary charge distribution in an ionic solution.
The solution is an extension of the <a class="reference internal" href="pbam-auto.html#pbamauto"><span class="std std-ref">analytical method</span></a>, leveraging fast-multipole methods as well as boundary elements.
Each molecule is coarse-grained as a system of overlapping spheres, whose surface charges are represented by multipole expansions.
For details on the method, please see <a class="reference external" href="http://pubs.acs.org/doi/abs/10.1021/ct100145f">Yap, Head-Gordon (2010)</a> and <a class="reference external" href="http://pubs.acs.org/doi/abs/10.1021/ct400048q">Yap, Head-Gordon (2013)</a>.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>If there’s only one mode to PBAM, let’s call it <code class="docutils literal notranslate"><span class="pre">pbsam</span></code> instead of <code class="docutils literal notranslate"><span class="pre">pbsam-auto</span></code>.</p>
</div>
<p>The current implementation of PB-SAM in APBS includes:</p>
<ul class="simple">
<li><p>Calculation of energies, forces and torques</p></li>
<li><p>Calculation of electrostatic potentials</p></li>
<li><p>Brownian dynamics simulations</p></li>
</ul>
<p>Keywords for this calculation type include:</p>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">ELEC pbsam-auto keywords:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="3dmap.html">3dmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="diff.html">diff</a></li>
<li class="toctree-l1"><a class="reference internal" href="dx.html">dx</a></li>
<li class="toctree-l1"><a class="reference internal" href="exp.html">exp</a></li>
<li class="toctree-l1"><a class="reference internal" href="grid2d.html">grid2d</a></li>
<li class="toctree-l1"><a class="reference internal" href="imat.html">imat</a></li>
<li class="toctree-l1"><a class="reference internal" href="msms.html">msms</a></li>
<li class="toctree-l1"><a class="reference internal" href="ntraj.html">ntraj</a></li>
<li class="toctree-l1"><a class="reference internal" href="pbc.html">pbc</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdie.html">pdie</a></li>
<li class="toctree-l1"><a class="reference internal" href="randorient.html">randorient</a></li>
<li class="toctree-l1"><a class="reference internal" href="runname.html">runname</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtype.html">runtype</a></li>
<li class="toctree-l1"><a class="reference internal" href="salt.html">salt</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdie.html">sdie</a></li>
<li class="toctree-l1"><a class="reference internal" href="surf.html">surf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/temp.html">temp</a></li>
<li class="toctree-l1"><a class="reference internal" href="term.html">term</a></li>
<li class="toctree-l1"><a class="reference internal" href="termcombine.html">termcombine</a></li>
<li class="toctree-l1"><a class="reference internal" href="tolsp.html">tolsp</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">units</a></li>
<li class="toctree-l1"><a class="reference internal" href="xyz.html">xyz</a></li>
</ul>
</div>
<div class="section" id="background-information">
<h2>Background information<a class="headerlink" href="#background-information" title="Permalink to this headline">¶</a></h2>
<p>PB-SAM is a semi-analytical solution to the linearized Poisson-Boltzmann equation for multiple molecules of arbitrary charge distribution in an ionic solution.
The solution is an extension of the analytical method, leveraging Fast-Multipole methods as well as boundary elements.
Each molecule is coarse-grained as a system of overlapping spheres, whose surface charges are represented by the multipole expansions <span class="math notranslate nohighlight">\(H^{(i)}\)</span> and <span class="math notranslate nohighlight">\(F^{(i)}\)</span>.
To solve for the potential, the following interactions are considered:</p>
<ul class="simple">
<li><p>Intra-molecular interactions between overlapping spheres are treated numerically</p></li>
<li><p>Intra-molecular interactions between non-overlapping spheres are treated analytically</p></li>
<li><p>Inter-molecular interactions between spheres on different molecules</p></li>
</ul>
<p>With these interactions, the multipole expansions are solved with an iterative SCF method, briefly given as</p>
<div class="math notranslate nohighlight">
\[\begin{split}H^{(i,k)} &amp;= I_{E}^{(i,k)} \cdot \left ( H^{(i,k)} + F^{(i,k)} + T \cdot H^{(j,l)} \right ) \\
F^{(i,k)} &amp;= I_{E}^{(i,k)} \cdot \left ( H^{(i,k)} + F^{(i,k)} + T \cdot F^{(j,l)} \right )\end{split}\]</div>
<p>Where <span class="math notranslate nohighlight">\(H^{(i)}\)</span> and :math`F^{(i)}` are multipole expansions, <span class="math notranslate nohighlight">\(I_{E}^{(i,k)}\)</span> is the exposed surface integral matrix for sphere <span class="math notranslate nohighlight">\(k\)</span> of molecule <span class="math notranslate nohighlight">\(i\)</span>, and <span class="math notranslate nohighlight">\(T\)</span> is an operator that transforms the multipole expansion to a local coordinate frame.</p>
<p>From the above formulation, computation of the interaction energy <span class="math notranslate nohighlight">\(\Omega^{(i)}\)</span> for molecule <span class="math notranslate nohighlight">\(i\)</span>, is given as a sum of all the interactions of spheres <span class="math notranslate nohighlight">\(k\)</span> within it with all external spheres (in a simplified form) as follows:</p>
<div class="math notranslate nohighlight">
\[\Omega^{(i)} = \frac{1}{\epsilon_s} \left \langle \sum_{k \, in\, i} \sum_{j \ne i}^N \sum_{l\, in \, j}  T \cdot H^{(j,l)} ,  H^{(i,k)} \right \rangle\]</div>
<p>where <span class="math notranslate nohighlight">\(\langle  M, N \rangle\)</span> denotes the inner product.</p>
<p>When energy is computed, forces follow as:</p>
<div class="math notranslate nohighlight">
\[\textbf{F}^{(i)} = \nabla_i \Omega^{(i)}=\frac{1}{\epsilon_s} [ \langle \nabla_i \,T \cdot H^{(j,l)} ,  H^{(i,k)} \rangle +  \langle T \cdot H^{(j,l)},   \nabla_i \, H^{(i,k)} \rangle\]</div>
<p>The method to calculate the torque is discussed in <a class="reference external" href="http://pubs.acs.org/doi/abs/10.1021/ct400048q">Yap, Head-Gordon (2013)</a>.</p>
</div>
<div class="section" id="pb-sam-files">
<h2>PB-SAM files<a class="headerlink" href="#pb-sam-files" title="Permalink to this headline">¶</a></h2>
<div class="section" id="vertex-surface-file">
<h3>Vertex/surface file<a class="headerlink" href="#vertex-surface-file" title="Permalink to this headline">¶</a></h3>
<p>As part of the coarse-graining process a definition of the molecular surface is necessary.
For this we have historically used the program <a class="reference external" href="http://mgltools.scripps.edu/packages/MSMS">MSMS</a>  or on the <cite>online MSMS web server</cite> &lt;<a class="reference external" href="http://mgl.scripps.edu/people/sanner/html/msms_server.html">http://mgl.scripps.edu/people/sanner/html/msms_server.html</a>&gt;`_.
Within APBS, the user can implement the <a class="reference internal" href="msms.html"><span class="doc">msms</span></a> flag and the program will be run through APBS, but the executable must be included in your path.</p>
<p>If using the command-line MSMS tool, after downloading it for the correct platform, it can be run as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./msms.system -if <span class="o">{</span>filename<span class="o">}</span>.xyzr -of <span class="o">{</span>outfile<span class="o">}</span>
</pre></div>
</div>
<p>It requires an <code class="file docutils literal notranslate"><em><span class="pre">filename</span></em><span class="pre">.xyzr</span></code> file as input, which is the xyz coordinates of each atom of the system followed by the VdW radius.
This information can all be found in the PQR file.
MSMS will produce <code class="file docutils literal notranslate"><em><span class="pre">outfile</span></em><span class="pre">.face</span></code> and <code class="file docutils literal notranslate"><em><span class="pre">outfile</span></em><span class="pre">.vert</span></code> file.
The vertex file is used to coarse-grain the molecule.
Once this has been generated, it can be used again as input using the <a class="reference internal" href="surf.html"><span class="doc">surf</span></a> command.</p>
</div>
<div class="section" id="coarse-grained-pqr-file">
<h3>Coarse-grained PQR file<a class="headerlink" href="#coarse-grained-pqr-file" title="Permalink to this headline">¶</a></h3>
<p>The coarse-graining process will produce a new PQR file <code class="file docutils literal notranslate"><span class="pre">mol</span><em><span class="pre">#</span></em><span class="pre">_cg.pqr</span></code> that contains the original PQR concatenated with coarse-graining spherical centers.
The number <cite>#</cite> refers to the order the file was read during the <a class="reference internal" href="../read.html"><span class="doc">READ input file section</span></a> statements.</p>
</div>
<div class="section" id="imat-surface-integral-file">
<h3>IMAT: surface integral file<a class="headerlink" href="#imat-surface-integral-file" title="Permalink to this headline">¶</a></h3>
<p>The surface integrals are computed for the boundary element part of PB-SAM.
Their calculation can be quite time-consuming, so the first time they are computed for a system, they are saved to the working directory with the name <code class="file docutils literal notranslate"><span class="pre">mol</span><em><span class="pre">m</span></em><span class="pre">sph</span><em><span class="pre">s</span></em><span class="pre">.bin`</span></code>.
The <em>m</em> in <code class="file docutils literal notranslate"><span class="pre">mol</span><em><span class="pre">m</span></em><span class="pre">sph</span><em><span class="pre">s</span></em><span class="pre">.bin`</span></code> is the ordered ID of the molecule from the PQR section.
The <em>s</em> in <code class="file docutils literal notranslate"><span class="pre">mol</span><em><span class="pre">m</span></em><span class="pre">sph</span><em><span class="pre">s</span></em><span class="pre">.bin`</span></code> refers to coarse-grained sphere <em>s</em> of the molecule.</p>
</div>
<div class="section" id="multipole-expansion-files">
<h3>Multipole expansion files<a class="headerlink" href="#multipole-expansion-files" title="Permalink to this headline">¶</a></h3>
<p>Much like the IMAT files, the expansion files are files generated from self-polarization that are useful and time-saving methods for running a system of full-mutual polarziation on many molecules.
If no expansion path is provided, the program will calculate self-polarization for each type of molecule in the system and save files of the form <code class="file docutils literal notranslate"><span class="pre">mol</span><em><span class="pre">m</span></em><em><span class="pre">H,F</span></em><span class="pre">.</span><em><span class="pre">s</span></em><span class="pre">.exp</span></code>, where <em>m</em> is the molecule ID, <em>H</em> and <em>F</em> refer to the respective expansion (see above), and <em>s</em> is the coarse-grained sphere number.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">APBS-PDB2PQR</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">APBS-PDB2PQR overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../downloads.html">How to get the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-help.html">Getting help</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">APBS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installing.html">Installing APBS</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../invoking.html">Invoking APBS</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">APBS input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../background.html">Solvation model background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../errors.html">Caveats and sources of error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../utilities/index.html">APBS utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../programming.html">APBS programmer’s guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../license.html">APBS license</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/index.html">File formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">APBS-PDB2PQR examples and tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support.html">Support for APBS-PDB2PQR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../citing.html">Citing your use of our software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reading.html">Suggested reading for APBS-PDB2PQR</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">APBS</a><ul>
  <li><a href="../../invoking.html">Invoking APBS</a><ul>
  <li><a href="../index.html">APBS input files</a><ul>
  <li><a href="index.html">ELEC input file section</a><ul>
      <li>Previous: <a href="xyz.html" title="previous chapter">xyz</a></li>
      <li>Next: <a href="exp.html" title="next chapter">exp</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Copyright (c) 2010-2020 Battelle Memorial Institute.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/apbs/input/elec/pbsam-auto.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>